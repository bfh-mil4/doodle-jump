<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Doodle Jump</title>
  <style>
    html, body {
      height: 100%;
      margin: 0;
      display: flex;
      justify-content: center;
      align-items: center;
      background-color: #282c34;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }
    canvas {
      border: 3px solid #00FF00;
      background-color: #add8e6;
      box-shadow: 0px 0px 15px 5px rgba(0, 255, 0, 0.75);
      width: 100%;
      height: 100%;
      max-width: 900px;
      max-height: 1600px;
      object-fit: contain;
    }
    #scoreboard {
      position: absolute;
      top: 10px;
      left: 10px;
      font-size: 24px;
      color: #00FF00;
      font-weight: bold;
      text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
    }
    #restart, #startButton {
      display: none;
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      font-size: 28px;
      padding: 15px 30px;
      background-color: #28a745;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      box-shadow: 0px 0px 10px rgba(0, 255, 0, 0.75);
      transition: all 0.3s ease;
    }
    #restart:hover, #startButton:hover {
      background-color: #218838;
      transform: translate(-50%, -50%) scale(1.05);
    }
    #restart {
      display: none;
      top: 70%;
    }
    #instructions {
      position: absolute;
      top: 20%;
      left: 50%;
      transform: translateX(-50%);
      text-align: center;
      font-size: 22px;
      color: #FFFFFF;
      text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
      background-color: rgba(0, 0, 0, 0.7);
      padding: 20px;
      border-radius: 10px;
      max-width: 80%;
    }
    #instructions h1 {
      margin-bottom: 20px;
      color: #00FF00;
      text-shadow: 0 0 10px rgba(0, 255, 0, 0.75);
    }
    #startButton {
      margin-top: 20px;
      display: block;
      position: relative;
      transform: none;
      left: 50%;
      transform: translateX(-50%);
    }
  </style>
</head>
<body>

<canvas id="gameCanvas" width="375" height="667"></canvas>
<div id="scoreboard">Score: 0 | Highscore: 0</div>
<div id="instructions">
  <h1>Willkommen zu Doodle Jump!</h1>
  <p>Steuere deinen Charakter mit den Pfeiltasten nach links und rechts.</p>
  <p>Je höher du springst, desto herausfordernder wird es.</p>
  <p>Zeige dein Können!</p>
  <button id="startButton">Spiel Starten</button>
</div>
<button id="restart">Erneut versuchen</button>

<script>
// Setup the canvas and context
const canvas = document.getElementById('gameCanvas');
const context = canvas.getContext('2d');
const scoreboard = document.getElementById('scoreboard');
const restartButton = document.getElementById('restart');
const startButton = document.getElementById('startButton');
const instructions = document.getElementById('instructions');

// Load game assets
const platformImage = new Image();
platformImage.src = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEEAAAAUCAYAAADStFABAAAACXBIWXMAAAsTAAALEwEAmpwYAAAF0WlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNy4yLWMwMDAgNzkuMWI2NWE3OWI0LCAyMDIyLzA2LzEzLTIyOjAxOjAxICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdEV2dD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlRXZlbnQjIiB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iIHhtbG5zOnBob3Rvc2hvcD0iaHR0cDovL25zLmFkb2JlLmNvbS9waG90b3Nob3AvMS4wLyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgMjQuMCAoTWFjaW50b3NoKSIgeG1wOkNyZWF0ZURhdGU9IjIwMjMtMTItMTNUMTQ6NDc6MTgrMDE6MDAiIHhtcDpNZXRhZGF0YURhdGU9IjIwMjMtMTItMTNUMTQ6NDc6MTgrMDE6MDAiIHhtcDpNb2RpZnlEYXRlPSIyMDIzLTEyLTEzVDE0OjQ3OjE4KzAxOjAwIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjY5ZDM0ZmQ1LTU0ZDItNDZiYi1hZmQ1LTNkNzE0ZjVhMzVhYyIgeG1wTU06RG9jdW1lbnRJRD0iYWRvYmU6ZG9jaWQ6cGhvdG9zaG9wOjVmZjA4ZmJiLTY3ZDAtYzU0OC1iMzA1LTBiZjY0ZjM3ZjVhZiIgeG1wTU06T3JpZ2luYWxEb2N1bWVudElEPSJ4bXAuZGlkOjI0ZTRhMzM5LTRmZDAtNDZiZi1hZmQ1LTNkNzE0ZjVhMzVhYyIgZGM6Zm9ybWF0PSJpbWFnZS9wbmciIHBob3Rvc2hvcDpDb2xvck1vZGU9IjMiPiA8eG1wTU06SGlzdG9yeT4gPHJkZjpTZXE+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJjcmVhdGVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOjI0ZTRhMzM5LTRmZDAtNDZiZi1hZmQ1LTNkNzE0ZjVhMzVhYyIgc3RFdnQ6d2hlbj0iMjAyMy0xMi0xM1QxNDo0NzoxOCswMTowMCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIDI0LjAgKE1hY2ludG9zaCkiLz4gPHJkZjpsaSBzdEV2dDphY3Rpb249InNhdmVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOjY5ZDM0ZmQ1LTU0ZDItNDZiYi1hZmQ1LTNkNzE0ZjVhMzVhYyIgc3RFdnQ6d2hlbj0iMjAyMy0xMi0xM1QxNDo0NzoxOCswMTowMCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIDI0LjAgKE1hY2ludG9zaCkiIHN0RXZ0OmNoYW5nZWQ9Ii8iLz4gPC9yZGY6U2VxPiA8L3htcE1NOkhpc3Rvcnk+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+YgB8UwAAAVBJREFUWIXtmDFOw0AQRd9EKVMgUVPmBKmpOQASBQ03gBNwAQouQIVEwwWgpqbkBEgpU6ZAouQEE2k3rCWvvYYC5j9pJe/M7Mx/3izrNcBTNpsBr8Aj8B4PTgF6wDXQyY5vgSPgGXgDPoHPeK4PXAEXQJnFvwOPwAvwgfrbPgs9C+AemNTqeQcegHfga6v+GBhHgSPgKQQPgRY1lRRxrgtsYnwELOO5U+AhxA6AE2AdYwvgLuYsge+QMwAuQ2wOrNJ6hsDNn/pjYBXnZ8Bnof4uME3xk5SYpqJLYJ2N3wGnQJPFdWpJxwV+Uv1NbB/7Jj6n+Gn8NvGtxG8T30r8b+K3jf+X+F3Fm8TvOt4kfh/xVfH7iq+K/4/4KiYp0KQpVlG6QhfxO9yU+KrfQRJfFW8SbxJvEr+PeJN4k3iTeJP4fcWbxJvEV8WbxFfFm8T/AErvzlYLQmYgAAAAAElFTkSuQmCC';

const playerImage = new Image();
playerImage.src = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADcAAAA3CAYAAACo29JGAAAACXBIWXMAAAsTAAALEwEAmpwYAAAF0WlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNy4yLWMwMDAgNzkuMWI2NWE3OWI0LCAyMDIyLzA2LzEzLTIyOjAxOjAxICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdEV2dD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlRXZlbnQjIiB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iIHhtbG5zOnBob3Rvc2hvcD0iaHR0cDovL25zLmFkb2JlLmNvbS9waG90b3Nob3AvMS4wLyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgMjQuMCAoTWFjaW50b3NoKSIgeG1wOkNyZWF0ZURhdGU9IjIwMjMtMTItMTNUMTQ6NDc6NDUrMDE6MDAiIHhtcDpNZXRhZGF0YURhdGU9IjIwMjMtMTItMTNUMTQ6NDc6NDUrMDE6MDAiIHhtcDpNb2RpZnlEYXRlPSIyMDIzLTEyLTEzVDE0OjQ3OjQ1KzAxOjAwIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjNhMzI0ZjZhLTU0ZDItNDZiYi1hZmQ1LTNkNzE0ZjVhMzVhYyIgeG1wTU06RG9jdW1lbnRJRD0iYWRvYmU6ZG9jaWQ6cGhvdG9zaG9wOjY3ZjA4ZmJiLTY3ZDAtYzU0OC1iMzA1LTBiZjY0ZjM3ZjVhZiIgeG1wTU06T3JpZ2luYWxEb2N1bWVudElEPSJ4bXAuZGlkOjNhMzI0ZjZhLTU0ZDItNDZiYi1hZmQ1LTNkNzE0ZjVhMzVhYyIgZGM6Zm9ybWF0PSJpbWFnZS9wbmciIHBob3Rvc2hvcDpDb2xvck1vZGU9IjMiPiA8eG1wTU06SGlzdG9yeT4gPHJkZjpTZXE+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJjcmVhdGVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOjNhMzI0ZjZhLTU0ZDItNDZiYi1hZmQ1LTNkNzE0ZjVhMzVhYyIgc3RFdnQ6d2hlbj0iMjAyMy0xMi0xM1QxNDo0Nzo0NSswMTowMCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIDI0LjAgKE1hY2ludG9zaCkiLz4gPC9yZGY6U2VxPiA8L3htcE1NOkhpc3Rvcnk+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+HyW/6wAAA01JREFUaIHtmj9oE1Ecx7+vpA1NbEtpg1bb4lAXBxddnEQXJycRdHB0EHRxcnJ0dHR0dHQQHZwcHRxEHRRxUgSVglYK2tqUBpvS/Gne93mXXC6XyyV3uVzSD4TS3Hvv+/t+7/fevXeXM8Vi8RKAPIAJAKcBvLDjQwBGAJwAMGTHXwN4B+ADgG8AvgP4Zc8NAzgO4ByAYTv2EsArAO8BfAXwE8Bfe24UwEkA5wGM2bHnAF4C+AjgB4Df9twIgFMALgAYt2PPALyw9fwA8MeeGwVwBsBFABN27CmA5wA+2Xr+2nNjAM4CmAQwacefAHgG4DOA37ae0R7qOQPgEoApW89jAE8BfAHwz54bA3AWwGUA03bsEYBZAJ/g6hkHcA7AFQDn7NhDAE8AfLX1/LPnxgGcB3AVwAU79gDAYwBfAPxH93pOA7gM4JId69TzD0DB1nMJwFU7dh/AIwBfAfxFuJ5xW881ANft2D0AswC+wdUzAeAigOsArtix2XY9/wEU4eq5DOCGHbtrz32Hq2cSwEUA1+3YHQCPbT0FhOs5Z+u5Ycdm4L6UPwjXcwHATTt2G8AjAD/h6pkCcAnATTt2C8BDAD/g6jkP4AqAW3bsJoAHcD9UmJ5JAFcB3LJjNwDMAfiOcD2XAdyyYzcAzMDVU0K4nksAbsHVcx3APIA/CNczCeAagNt27BqAB3D1lBGuZxLAVQB37Ng1APfh6vHTcxnAHTt21Z77gXA9kwBuArhrx64AuAdXTxnheqYA3ABwz45dtu/5F8L1TAG4DuC+HbsE4C5cPRWE65kCcA3AAzt2EcAduHqqCNczBeAqgId27AKAO3D11BCuZwrAFQCP7Nh5ALfh6qkjXM8UgMsAZuzYOQC34OppIFzPFIBLAB7bsbMAbsLV00S4nikAFwE8sWNnANyAq6eFcD1TAC4AeGrHTgO4DldPG+F6pgBMA3hmx04BmIarp4NwPVMAzgN4bsdOApgC0ES4nikA5wA8t2MnAEzC1dNFuJ4pAGcBvLBjxwFMwNXjp2cawEs7NgVgHK6eHsL1TAE4A+CVHRsDMA5Xj5+eaQCv7dgYgDG4evoI1zMF4DSANwBGAYzC1RNEzzSAtwBGAIzA1TNAP3qmALwDMAxgGK6eQfrRMwXgPYAhAENw9QzSj54pAB8ADAIYRL+efwx8lZk8hYDwAAAAAElFTkSuQmCC';

let isImageLoaded = false;

// Wait for images to load
Promise.all([
  new Promise(resolve => platformImage.onload = resolve),
  new Promise(resolve => playerImage.onload = resolve)
]).then(() => {
  isImageLoaded = true;
});

// Function to start the game
function startGame() {
  canvas.style.display = 'block';
  instructions.style.display = 'none';
  scoreboard.style.display = 'block';
  restartButton.style.display = 'none';
  resetGame();
}

// Start button event listener
startButton.addEventListener('click', startGame);

// Game constants and variables
const platformWidth = 65;
const platformHeight = 20;
const gravity = 0.3;
const bounceVelocity = -12;
const horizontalSpeed = 2;
let minPlatformGap = 120;
let maxPlatformGap = 200;
let gameStarted = false;
let platforms = [{ x: canvas.width / 2 - platformWidth / 2, y: canvas.height - platformHeight - 10 }];
let score = 0;
let highscore = 0;
let gameOver = false;
let isLeftPressed = false;
let isRightPressed = false;
let cameraOffsetY = 0;
const doodle = {
  width: 55,
  height: 55,
  x: canvas.width / 2 - 20,
  y: canvas.height - platformHeight - 60,
  dx: 0,
  dy: 0,
  highestY: canvas.height - platformHeight - 60
};
let particles = [];

// Function to send score to SharePoint web part
function sendScore(score) {
  try {
    window.parent.postMessage({
      score: score
    }, '*');
  } catch (error) {
    console.error('Error sending score:', error);
  }
}

function createParticles(x, y) {
  for (let i = 0; i < 10; i++) {
    particles.push({
      x: x,
      y: y,
      dx: (Math.random() - 0.5) * 2,
      dy: (Math.random() - 0.5) * 2,
      size: Math.random() * 3 + 1,
      alpha: 1
    });
  }
}

function updateParticles() {
  for (let i = particles.length - 1; i >= 0; i--) {
    const particle = particles[i];
    particle.x += particle.dx;
    particle.y += particle.dy;
    particle.alpha -= 0.02;
    if (particle.alpha <= 0) {
      particles.splice(i, 1);
    }
  }
}

function renderParticles() {
  context.fillStyle = 'rgba(255, 255, 255, 0.8)';
  particles.forEach(particle => {
    context.globalAlpha = particle.alpha;
    context.beginPath();
    context.arc(particle.x, particle.y, particle.size, 0, Math.PI * 2);
    context.fill();
  });
  context.globalAlpha = 1;
}

document.addEventListener('keydown', (e) => {
  gameStarted = true;
  if (e.key === 'ArrowLeft') isLeftPressed = true;
  if (e.key === 'ArrowRight') isRightPressed = true;
});

document.addEventListener('keyup', (e) => {
  if (e.key === 'ArrowLeft') isLeftPressed = false;
  if (e.key === 'ArrowRight') isRightPressed = false;
});

function resetGame() {
  score = 0;
  gameStarted = false;
  doodle.x = canvas.width / 2 - 20;
  doodle.y = canvas.height - platformHeight - 60;
  doodle.dy = 0;
  doodle.highestY = canvas.height - platformHeight - 60;
  platforms = [{ x: canvas.width / 2 - platformWidth / 2, y: canvas.height - platformHeight - 10 }];
  cameraOffsetY = 0;
  let platformY = canvas.height - platformHeight - 10;
  while (platformY > 0) {
    platformY -= platformHeight + minPlatformGap + Math.random() * (maxPlatformGap - minPlatformGap);
    const platformX = Math.random() * (canvas.width - platformWidth);
    platforms.push({ x: platformX, y: platformY });
  }
  gameOver = false;
  restartButton.style.display = 'none';
  requestAnimationFrame(gameLoop);
}

function gameLoop() {
  context.clearRect(0, 0, canvas.width, canvas.height);
  if (gameStarted) doodle.dy += gravity;
  doodle.x += doodle.dx;
  doodle.y += doodle.dy;
  if (doodle.y < canvas.height / 2) {
    const offset = canvas.height / 2 - doodle.y;
    cameraOffsetY += offset;
    doodle.y = canvas.height / 2;
    platforms.forEach(platform => platform.y += offset);
  }
  if (cameraOffsetY > doodle.highestY) {
    score++;
    doodle.highestY = cameraOffsetY;
    scoreboard.innerText = `Score: ${score} | Highscore: ${highscore}`;
  }
  platforms.forEach((platform) => {
    if (
      doodle.dy > 0 &&
      doodle.x + doodle.width * 0.8 > platform.x &&
      doodle.x + doodle.width * 0.2 < platform.x + platformWidth &&
      doodle.y + doodle.height >= platform.y &&
      doodle.y + doodle.height <= platform.y + platformHeight
    ) {
      doodle.dy = bounceVelocity;
      createParticles(doodle.x + doodle.width / 2, doodle.y + doodle.height);
    }
  });
  platforms = platforms.filter(platform => platform.y < canvas.height);
  if (platforms[platforms.length - 1].y > 0) {
    const newPlatformX = Math.random() * (canvas.width - platformWidth);
    const newPlatformY = platforms[platforms.length - 1].y - platformHeight - minPlatformGap - Math.random() * (maxPlatformGap - minPlatformGap);
    platforms.push({ x: newPlatformX, y: newPlatformY });
  }
  if (isLeftPressed) doodle.dx = -horizontalSpeed;
  else if (isRightPressed) doodle.dx = horizontalSpeed;
  else doodle.dx = 0;
  if (doodle.x + doodle.width < 0) doodle.x = canvas.width;
  else if (doodle.x > canvas.width) doodle.x = -doodle.width;
  platforms.forEach(platform => {
    context.drawImage(platformImage, platform.x, platform.y, platformWidth, platformHeight);
  });
  if (isImageLoaded) {
    context.drawImage(playerImage, doodle.
drawImage(playerImage, doodle.x, doodle.y, doodle.width, doodle.height);
  }
  updateParticles();
  renderParticles();
  if (doodle.y - cameraOffsetY > canvas.height) endGame();
  if (!gameOver) requestAnimationFrame(gameLoop);
}

function endGame() {
  gameOver = true;
  if (score > highscore) {
    highscore = score;
    sendScore(score);
  }
  scoreboard.innerText = `Score: ${score} | Highscore: ${highscore}`;
  restartButton.style.display = 'block';
}

restartButton.addEventListener('click', () => {
  resetGame();
});

canvas.style.display = 'none';
</script>

</body>
</html>
